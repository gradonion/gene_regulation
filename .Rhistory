# sum_fit = summary(lm(y ~ x))
R_sq[i] = sum_fit$r.squared
}
names(R_sq) = names(exp_RNA)
R_sq = R_sq[-which(R_sq==1)]
dat = data.frame(r_square = R_sq, row.names = names(R_sq))
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_',npc,'PCs.txt')
write.table(dat, file=filename, quote = F, sep = "\t", col.names = F)
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
hist_gen = function(R_sq,filename){
target = read.table(filename, header = FALSE, na.strings = 'NA', stringsAsFactors = FALSE)
seq = 1:length(R_sq$rsquare)
target_order = match(target$V1, row.names(R_sq))
nontarget_order = seq[-target_order]
r_sq = R_sq$rsquare[target_order]
if (length(r_sq[-which(r_sq==1)])>0){
r_sq = r_sq[-which(r_sq==1)]
}
term = paste("Number of target genes:",length(r_sq))
print(term)
term = paste("Proportion among all genes:",round(length(r_sq)/length(R_sq$rsquare),digits = 4))
print(term)
hist_0 = hist(r_sq, plot = FALSE)
hist_0$density = hist_0$counts/sum(hist_0$counts)*100
non_r_sq = R_sq$rsquare[nontarget_order]
if (length(non_r_sq[-which(non_r_sq==1)])>0){
non_r_sq = non_r_sq[-which(non_r_sq==1)]
}
hist_1 = hist(non_r_sq, plot = FALSE)
hist_1$density = hist_1$counts/sum(hist_1$counts)*100
return(list(hist_0,hist_1))
}
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
target = read.table(filename, header = FALSE, na.strings = 'NA', stringsAsFactors = FALSE)
View(target)
target_order = match(target$V1, row.names(R_sq))
nontarget_order = seq[-target_order]
target_order[target_order==0]
target_order[is.na(target_order)]
target_order[target_order==1]
target_order[target_order==2]
y = exp_RNA[,which(RNA$Description==TF)]
R_sq = rep(NA,length(names(exp_RNA)))
npc = 2
phrase = "pca.RNA$rotation[, \"PC1\"]"
if (npc>1){
for (i in 2:npc){
tmp = paste0("+pca.RNA$rotation[, \"PC",i,"\"]")
phase = paste0(phase, tmp)
}
}
express_x = paste("x ~", phrase)
express_y = paste("y ~", phrase)
for (i in 1:length(names(exp_RNA))){
x = exp_RNA[,names(exp_RNA)[i]]
fit_x_pc = summary( lm(as.formula(express_x)) )
fit_y_pc = summary( lm(as.formula(express_y)) )
# fit_x_pc = summary( lm(x ~ pca.RNA$rotation[, "PC1"] + pca.RNA$rotation[, "PC2"]) )
# fit_y_pc = summary( lm(y ~ pca.RNA$rotation[, "PC1"] + pca.RNA$rotation[, "PC2"]) )
sum_fit = summary(lm(fit_y_pc$residuals ~ fit_x_pc$residuals - 1))
# sum_fit = summary(lm(y ~ x))
R_sq[i] = sum_fit$r.squared
}
names(R_sq) = names(exp_RNA)
dat = data.frame(r_square = R_sq, row.names = names(R_sq))
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_',npc,'PCs.txt')
write.table(dat, file=filename, quote = F, sep = "\t", col.names = F)
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,55), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
hist[[2]]$density
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,70), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
## pca.RNA$rotation : 75 cell lines by 75 PCs (projections on PCs)
TF_names = c("STAT1","YY1","CEBPB","SP1","NFYA")
for (TF in TF_names){
y = exp_RNA[,which(RNA$Description==TF)]
R_sq = rep(NA,length(names(exp_RNA)))
npc = 2
phrase = "pca.RNA$rotation[, \"PC1\"]"
if (npc>1){
for (i in 2:npc){
tmp = paste0("+pca.RNA$rotation[, \"PC",i,"\"]")
phase = paste0(phase, tmp)
}
}
express_x = paste("x ~", phrase)
express_y = paste("y ~", phrase)
for (i in 1:length(names(exp_RNA))){
x = exp_RNA[,names(exp_RNA)[i]]
fit_x_pc = summary( lm(as.formula(express_x)) )
fit_y_pc = summary( lm(as.formula(express_y)) )
# fit_x_pc = summary( lm(x ~ pca.RNA$rotation[, "PC1"] + pca.RNA$rotation[, "PC2"]) )
# fit_y_pc = summary( lm(y ~ pca.RNA$rotation[, "PC1"] + pca.RNA$rotation[, "PC2"]) )
sum_fit = summary(lm(fit_y_pc$residuals ~ fit_x_pc$residuals - 1))
# sum_fit = summary(lm(y ~ x))
R_sq[i] = sum_fit$r.squared
}
names(R_sq) = names(exp_RNA)
dat = data.frame(r_square = R_sq, row.names = names(R_sq))
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_',npc,'PCs.txt')
write.table(dat, file=filename, quote = F, sep = "\t", col.names = F)
}
## pca.RNA$rotation : 75 cell lines by 75 PCs (projections on PCs)
TF_names = c("IRF4","STAT1","YY1","CEBPB","SP1","NFYA")
## pca.RNA$rotation : 75 cell lines by 75 PCs (projections on PCs)
TF_names = c("IRF4","YY1","CEBPB","SP1","NFYA")
for (TF in TF_names){
y = exp_RNA[,which(RNA$Description==TF)]
R_sq = rep(NA,length(names(exp_RNA)))
npc = 0
phrase = "pca.RNA$rotation[, \"PC1\"]"
if (npc>1){
for (i in 2:npc){
tmp = paste0("+pca.RNA$rotation[, \"PC",i,"\"]")
phase = paste0(phase, tmp)
}
}
express_x = paste("x ~", phrase)
express_y = paste("y ~", phrase)
for (i in 1:length(names(exp_RNA))){
x = exp_RNA[,names(exp_RNA)[i]]
fit_x_pc = summary( lm(as.formula(express_x)) )
fit_y_pc = summary( lm(as.formula(express_y)) )
# fit_x_pc = summary( lm(x ~ pca.RNA$rotation[, "PC1"] + pca.RNA$rotation[, "PC2"]) )
# fit_y_pc = summary( lm(y ~ pca.RNA$rotation[, "PC1"] + pca.RNA$rotation[, "PC2"]) )
# sum_fit = summary(lm(fit_y_pc$residuals ~ fit_x_pc$residuals - 1))
sum_fit = summary(lm(y ~ x))
R_sq[i] = sum_fit$r.squared
}
names(R_sq) = names(exp_RNA)
dat = data.frame(r_square = R_sq, row.names = names(R_sq))
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_',npc,'PCs.txt')
write.table(dat, file=filename, quote = F, sep = "\t", col.names = F)
}
TF = "IRF4"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/chipseq_w_motifs/',TF,'_peaks_w_motifs_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,70), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
TF = "IRF4"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,70), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "IRF4"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.6), ylim = c(0,70), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "IRF4"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.6), ylim = c(0,70), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "IRF4"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/chipseq_w_motifs/',TF,'_peaks_w_motifs_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.6), ylim = c(0,70), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
mtext("target genes: peaks w/ motifs & overlap w/ 3kb promoter", col = "gray30")
TF = "IRF4"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/chipseq_w_motifs/',TF,'_peaks_w_motifs_HiC.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.6), ylim = c(0,70), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
mtext("target genes: linked by HiC through peaks w/ motifs and in DHS & H3K27ac", col = "gray30")
TF = "STAT1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_in_prom_w_H3K27ac_targets.txt')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,55), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter & H3K27ac", col = "gray30")
TF = "YY1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_in_prom_w_H3K27ac_targets.txt')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,55), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter & H3K27ac", col = "gray30")
TF = "YY1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_in_prom_w_H3K27ac_targets.txt')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,55), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter & H3K27ac", col = "gray30")
TF = "YY1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_in_prom_w_H3K27ac_targets.txt')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,60), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter & H3K27ac", col = "gray30")
TF = "YY1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_in_prom_w_H3K27ac_targets.txt')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,60), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter & H3K27ac", col = "gray30")
TF = "CEBPB"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_in_prom_w_H3K27ac_targets.txt')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,60), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter & H3K27ac", col = "gray30")
TF = "CEBPB"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_in_prom_w_H3K27ac_targets.txt')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,60), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter & H3K27ac", col = "gray30")
TF = "CEBPB"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_in_prom_w_H3K27ac_targets.txt')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.6), ylim = c(0,70), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter & H3K27ac", col = "gray30")
TF = "CEBPB"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_in_prom_w_H3K27ac_targets.txt')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.6), ylim = c(0,75), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter & H3K27ac", col = "gray30")
TF = "CEBPB"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_in_prom_w_H3K27ac_targets.txt')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.6), ylim = c(0,75), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter & H3K27ac", col = "gray30")
TF = "NFYA"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.targets')
hist = hist_gen(R_sq,filename)
TF = "NFYA"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.6), ylim = c(0,75), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "NFYA"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.65), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "NFYA"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.65), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
setwd("~/web")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.65), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/chipseq_w_motifs/',TF,'_peaks_w_motifs_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.6), ylim = c(0,70), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
mtext("target genes: peaks w/ motifs & overlap w/ 3kb promoter", col = "gray30")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/chipseq_w_motifs/',TF,'_peaks_w_motifs_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
mtext("target genes: peaks w/ motifs & overlap w/ 3kb promoter", col = "gray30")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.8), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.75), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.7), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_0PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/3kb_promoter_chipseq/',TF,'_UniPk_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 0PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.75), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
# mtext("target genes: linked by HiC through top 10% peaks in DHS & H3K27ac", col = "gray30")
mtext("target genes: peaks overlap w/ 3kb promoter", col = "gray30")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/chipseq_w_motifs/',TF,'_peaks_w_motifs_3kb_prom.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.75), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
mtext("target genes: peaks w/ motifs & overlap w/ 3kb promoter", col = "gray30")
TF = "SP1"
filename = paste0('~/Downloads/Research/LCL/',TF,'_all_genes_R2_2PCs.txt')
R_sq = read.table(filename, sep = "\t", header = FALSE, row.names = 1, na.strings = 'NA',
stringsAsFactors = FALSE, col.names = c("gene_id","rsquare"))
filename = paste0('~/Downloads/Research/LCL/chipseq_w_motifs/',TF,'_peaks_w_motifs_HiC.target')
hist = hist_gen(R_sq,filename)
title = paste0("[",TF," ~ Target] vs [",TF,"~ Non-target] (- 2PCs) R2")
plot(hist[[1]]$mids, hist[[1]]$density, xlim = c(0,0.75), ylim = c(0,65), type = "o", col = "red",
main = title, xlab = expression("R"^2), ylab = "Density (%)")
lines(hist[[2]]$mids, hist[[2]]$density,  type = "o", col = "blue")
mtext("target genes: linked by HiC through peaks w/ motifs and in DHS & H3K27ac", col = "gray30")
nstep = 500000
set.seed(100)
x = rep(0,nstep)
for (i in 1:(nstep-1)){
g = sqrt(-2*log(runif(1))) * cos(2*pi*runif(1))
x[i+1] = x[i] + 0.0001/0.5915 * (-0.004*(x[i]^3)+0.1*x[i]-0.003) + g
}
plot(x,type = "l",col="blue",xlab = "time step",main = "Brownian Dynamics Trajectory")
hist(x)
